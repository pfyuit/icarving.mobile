<ion-view view-title="个人">   
     <ion-content>
      <div class="item item-avatar" style="margin-bottom: 25px;">
         <img src="img/car_pick.jpg">
         <h2>Marty McFly</h2>
      </div>
      <ion-tabs class="tabs-striped tabs-top">
          <ion-tab title="活动" on-select="selectActivity()">
          </ion-tab>
          <ion-tab title="通知" on-select="selectNotify()" badge="notifyLength" badge-style="badge-assertive">
          </ion-tab>
          <ion-tab title="留言" on-select="selectMessage()" badge="messageLength" badge-style="badge-assertive">
          </ion-tab>
      </ion-tabs>
         <ion-refresher  pulling-text="下拉刷新..." on-refresh="doRefresh()"></ion-refresher> 
         <div class="list card" ng-if="showActivity" style="margin-top: 0px;" ng-repeat="activity in activities | orderBy:'activityId' :reverse=true">               
           <div class="item item-avatar">
             <img src="{{activity.ownerAvatar}}">
             <h2>{{activity.ownerName}}</h2>
             <h4>{{activity.ownerCountry}} {{activity.ownerProvince}} {{activity.ownerCity}}</h4>
           </div>              
           <div class="item item-body">
            <h3 style="margin-top: 0px;"> 拼车类型：{{activity.type}} </h3>
            <h3> 地点：{{activity.sourceAddress}} -> {{activity.destAddress}} </h3>
            <h3> 时间：{{activity.startTime}} -> {{activity.returnTime}} </h3>
            <h3> 容纳人数：{{activity.capacity}} </h3>
            <h3 ng-if="activity.pick">剩余空位：{{activity.capacity-activity.approveNumber}}</h3><h3 ng-if="activity.picked">搭车人数：{{activity.capacity}}</h3>
            <h3> 手机：{{activity.ownerPhone}} </h3>
            <h3> 费用：{{activity.charge}} </h3>
            <h3> 汽车类型：{{activity.carType}} </h3>
            <h3> 说明：{{activity.note}} </h3>          
            <hr/>                 
            <p>
              <a ng-if="!activity.my && activity.pick" href="#" class="subdued">{{activity.applyNumber}}个搭车申请，{{activity.approveNumber}}人被批准     <h4 ng-if="activity.applied">(您已申请，状态：{{activity.myapply.status}})</h4></a>
              <a ng-if="activity.my && activity.pick" href="#/tab/my/activitydetailapply/{{activity.activityId}}" class="subdued">{{activity.applyNumber}}个搭车申请，{{activity.approveNumber}}人被批准 </a>
              <a ng-if="!activity.my && activity.picked" href="#" class="subdued">{{activity.applyNumber}}个车主申请   <h4 ng-if="activity.applied">(您已申请，状态：{{activity.myapply.status}})</h4></a>
              <a ng-if="activity.my && activity.picked" href="#/tab/my/activitydetailapply/{{activity.activityId}}" class="subdued">{{activity.applyNumber}}个车主申请 </a>
            </p>                 
           </div>              
           <div class="item tabs tabs-secondary tabs-icon-left">
             <a ng-if="!activity.my && activity.pick && !activity.applied" class="tab-item" href="#" ng-click="applyActivity()">
               <i class="icon ion-thumbsup"></i>
                                       搭车
             </a>
             <a ng-if="!activity.my && activity.picked && !activity.applied" class="tab-item" href="#" ng-click="applyActivity()">
               <i class="icon ion-thumbsup"></i>
                                       捡TA
             </a>
             <a ng-if="!activity.my && activity.applied" class="tab-item" href="#" ng-click="cancelApply(activity.myapply.applyId)">
               <i class="icon ion-minus-circled"></i>
                                      取消申请
             </a>
             <a ng-if="activity.my" class="tab-item" href="#/tab/my/activitydetailupdate/{{activity.activityId}}">
               <i class="icon ion-edit"></i>
                                      修改
             </a>
             <a ng-if="activity.my" class="tab-item" href="#" ng-click="cancelActivity()">
               <i class="icon ion-minus-circled"></i>
                                       取消
             </a>
             <a class="tab-item" href="#">
               <i class="icon ion-chatbox"></i>
                                        留言
             </a>
             <a class="tab-item" href="#">
               <i class="icon ion-share"></i>
                                 分享
             </a>
           </div>             
         </div>
          
         <ion-list ng-if="showNotify" scroll="false" animation="fade-out">
            <ion-item  class="item-icon-right" ng-repeat="msg in notifies" href="#/tab/my/activitydetail/{{msg.activityId}}/{{msg.messageId}}">
               <h3 ng-class="{newmessage: msg.isNew, oldmessage: msg.isOld}">{{msg.content}}</h3>
               <h4 ng-class="{newmessage: msg.isNew, oldmessage: msg.isOld}">{{msg.activitySourceAddress}} -> {{msg.activityDestAddress}}</h4>
               <i class="icon ion-chevron-right icon-accessory"></i>
            </ion-item>
         </ion-list>
         
        <ion-list ng-if="showMessage" scroll="false" animation="fade-out">
            <ion-item  class="item-icon-right" ng-repeat="msg in msgs" href="#/tab/my/activitydetail/{{msg.activityId}}/{{msg.messageId}}">
               <h3 ng-class="{newmessage: msg.isNew, oldmessage: msg.isOld}">{{msg.content}}</h3>
               <h4 ng-class="{newmessage: msg.isNew, oldmessage: msg.isOld}">{{msg.activitySourceAddress}} -> {{msg.activityDestAddress}}</h4>
               <i class="icon ion-chevron-right icon-accessory"></i>
            </ion-item>
         </ion-list>
 
       <button class="button button-block button-assertive" ng-click="logoff()">
           <i class="icon ion-power"></i>&nbsp;退出登录
       </button>
  </ion-content>
</ion-view>
